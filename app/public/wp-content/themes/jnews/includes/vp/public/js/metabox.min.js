!function(t){"use strict";function e(e){e.each(function(){if(t(this).parents(".tocopy").length<=0){vp.init_controls(t(this));var e=t(this).attr("id"),i=(t(this).attr("id"),t(this).attr("data-vp-validation")),n=t(this).attr("data-vp-bind"),a=t(this).attr("data-vp-items-bind"),r=t(this).attr("data-vp-dependency"),s=t(this).attr("data-active-callback"),o=t(this).getDatas().type;i&&l.push({name:e,rules:i,type:o}),"undefined"!=typeof n&&n!==!1&&n&&c.push({bind:n,type:o,source:e}),"undefined"!=typeof a&&a!==!1&&a&&v.push({bind:a,type:o,source:e}),"undefined"!=typeof r&&r!==!1&&r&&f.push({dep:r,type:"field",source:e}),"undefined"!=typeof s&&s!==!1&&s&&h.push({callback:s,type:"field",source:e})}})}function i(e){e.each(function(){if(t(this).parents(".tocopy").length<=0&&!t(this).hasClass(".tocopy")){var e=t(this).attr("data-vp-dependency"),i=t(this).attr("data-active-callback"),n=(t(this).getDatas().type,t(this).attr("id"));"undefined"!=typeof e&&e!==!1&&e&&f.push({dep:e,type:"section",source:n}),"undefined"!=typeof i&&i!==!1&&i&&h.push({callback:i,type:"section",source:n})}})}function n(){var e=[];t(".wpa_loop.vp-sortable").sortable({items:">.wpa_group",handle:".vp-wpa-group-heading",axis:"y",opacity:.5,tolerance:"pointer",start:function(i,n){"undefined"!=typeof window.KIA_metabox&&(e=[],vp.tinyMCE_save(),t(n.item).find(".customEditor textarea").each(function(){if(t(this).parents(".tocopy").length<=0){try{tinyMCE.execCommand("mceRemoveControl",!1,this.id)}catch(i){}e.push(vp.jqid(this.id))}}))},stop:function(i,n){if("undefined"!=typeof window.KIA_metabox){for(var a=e.length-1;a>=0;a--){var r=t(e[a]);r.val(switchEditors.wpautop(r.val()))}e=e.join(", ");try{KIA_metabox.runTinyMCE(t(e)),vp.tinyMCE_save();for(var a=e.length-1;a>=0;a--){var r=t(e[a]);r.val(switchEditors.pre_wpautop(r.val()))}}catch(s){}}}})}function a(t){for(var e=0;e<t.length;e++){var i=t[e],n=i.bind.split("|"),a=n[0],r=n[1],s=[],o="";o=i.source.replace("[]",""),o=o.substring(0,o.lastIndexOf("[")),r=r.split(/[\s,]+/);for(var p=0;p<r.length;p++)r[p]=o+"["+r[p]+"]",s.push(r[p]);for(p=0;p<s.length;p++)vp.binding_event(s,p,i,a,".vp-metabox","metabox")}}function r(t){for(var e=0;e<t.length;e++){var i=t[e],n=i.bind.split("|"),a=n[0],r=n[1],s=[],o="";o=i.source.replace("[]",""),o=o.substring(0,o.lastIndexOf("[")),r=r.split(/[\s,]+/);for(var p=0;p<r.length;p++)r[p]=o+"["+r[p]+"]",s.push(r[p]);for(p=0;p<s.length;p++)vp.items_binding_event(s,p,i,a,".vp-metabox","metabox")}}function s(t){for(var e=0;e<t.length;e++){var i=t[e],n=i.dep.split("|"),a=n[0],r=n[1],s=[],o="";if("field"===i.type)o=i.source.replace("[]",""),o=o.substring(0,o.lastIndexOf("["));else if("section"===i.type){var p=jQuery(vp.jqid(i.source));p.parents(".wpa_group").length>0?o=jQuery(vp.jqid(i.source)).parents(".wpa_group").first().attr("id"):(o=jQuery(vp.jqid(i.source)).parents(".postbox").attr("id"),o=o.substring(0,o.lastIndexOf("_")))}r=r.split(",");for(var u=0;u<r.length;u++)r[u]=o+"["+r[u]+"]",s.push(r[u]);for(u=0;u<s.length;u++)vp.dependency_event(s,u,i,a,".vp-metabox")}}function o(t){for(var e=0;e<t.length;e++){var i=t[e],n=JSON.parse(i.callback),a="";if("field"===i.type)a=i.source.replace("[]",""),a=a.substring(0,a.lastIndexOf("["));else if("section"===i.type){var r=jQuery(vp.jqid(i.source));r.parents(".wpa_group").length>0?a=jQuery(vp.jqid(i.source)).parents(".wpa_group").first().attr("id"):(a=jQuery(vp.jqid(i.source)).parents(".postbox").attr("id"),a=a.substring(0,a.lastIndexOf("_")))}for(var s=0;s<n.length;s++){var o=n[s],d=a+"["+o.field+"]";p(d,a,i)}u(a,i)}}function p(e,i,n){var a=vp.thejqname(e,"option");t(".vp-metabox").on("change",a,function(){u(i,n)})}function u(t,e){for(var i=JSON.parse(e.callback),n=jQuery(vp.jqid(e.source)),a=[],r=!0,s=0;s<i.length;s++){var o=i[s],p=t+"["+o.field+"]",u=jQuery('[name="'+p+'"]').validationVal(),l=!1;a.push(jQuery(vp.jqid(p))),l=d(o.operator,o.value,u),l||(r=!1)}r?(n.removeClass("vp-dep-inactive"),n.vp_fadeIn()):(n.addClass("vp-dep-inactive"),n.vp_fadeOut())}function d(t,e,i){if("==="===t)return e===i;if("="===t||"=="===t)return e==i;if("!=="===t)return e!==i;if("!="===t)return e!=i;if(">="===t)return e>=i;if("<="===t)return i>=e;if(">"===t)return e>i;if("<"===t)return i>e;if("in"===t){var n=e.indexOf(i);return n>=0}if("ex"===t){var n=e.indexOf(i);return 0>n}}var l=[],c=[],v=[],f=[],h=[];t(".vp-metabox").on("click",".vp-wpa-group-title",function(e){e.preventDefault();var i=t(this).parents(".wpa_group:first"),n=i.find(".vp-controls:first");i.siblings(".wpa_group:not(.tocopy)"),t("html, body");return n.hasClass("vp-hide")?n.slideUp(0,function(){t(this).removeClass("vp-hide").slideDown("fast")}):n.slideUp("fast",function(){t(this).addClass("vp-hide").slideDown(0)}),!1}),t(document).ready(function(){e(jQuery(".vp-metabox .vp-field")),i(jQuery(".vp-metabox .vp-meta-group")),a(c),r(v),s(f),o(h),n()}),vp.is_multianswer=function(t){var e=["vp-checkbox","vp-checkimage","vp-multiselect"];return-1!==jQuery.inArray(t,e)?!0:!1},vp.custom_check_radio_event(".vp-metabox",".vp-field.vp-checkimage .field .input label"),vp.custom_check_radio_event(".vp-metabox",".vp-field.vp-radioimage .field .input label"),t("#post").on("submit",function(e){var i=t("input[type=submit][clicked=true]"),n=i.val(),a=0;if(vp.tinyMCE_save(),t(".vp-field").removeClass("vp-error"),t(".validation-msg.vp-error").remove(),t(".vp-metabox-error").remove(),a=vp.fields_validation_loop(l),a>0){var r=t('<span class="vp-metabox-error vp-js-tipsy" original-title="'+a+' error(s) found in metabox"></span>');"Save Draft"===n?(t("#minor-publishing-actions .spinner, #minor-publishing-actions .ajax-loading").hide(),r.tipsy(),r.insertAfter("#minor-publishing-actions .spinner, #minor-publishing-actions .ajax-loading"),t("#save-post").prop("disabled",!1).removeClass("button-disabled")):("Publish"===n||"Update"===n)&&(t("#publishing-action .spinner, #publishing-action .ajax-loading").hide(),r.tipsy(),r.insertAfter("#publishing-action .spinner, #publishing-action .ajax-loading"),t("#publish").prop("disabled",!1).removeClass("button-primary-disabled"));var s=Math.ceil((i.outerHeight()-r.height())/2);return s>0&&r.css("margin-top",s),void e.preventDefault()}t(this).find(".vp-toggle .vp-input").each(function(){var e=t("<input>",{type:"hidden",name:this.name,value:0});t(this).before(e)})}),t("#post input[type=submit]").click(function(){t("input[type=submit]",t(this).parents("form")).removeAttr("clicked"),t(this).attr("clicked","true")}),t.wpalchemy.on("wpa_copy",function(t,n){c=[],f=[],v=[],n.find('input[class="tocopy-hidden"]').first().remove(),e(n.find(".vp-field")),i(n.find(".vp-meta-group")),n.find(".vp-wpa-group-title:first").click(),a(c),r(v),s(f),o(h)})}(jQuery),function(t){"use strict";function e(){var e=t(".vp-multitermhierarchy-wrapper input.input-sortable");e.each(function(){if(t(this).hasClass("selectized"));else{var e=t(this).parent(),i=e.find(".data-option");i.length&&(i=JSON.parse(i.text()),t(this).selectize({plugins:["drag_drop","remove_button"],options:i,persist:!0,create:!1,hideSelected:!0,render:{option:function(t,e){return'<div class="'+t["class"]+'"><span>'+t.text+"</span></div>"}}}))}})}function i(){var e=t(".vp-multipost-wrapper input.input-sortable");e.each(function(){if(t(this).hasClass("selectized"));else{var e=t(this).parent(),i=e.find(".data-option");i=JSON.parse(i.text()),t(this).selectize({plugins:["drag_drop","remove_button"],persist:!0,create:!1,options:i,hideSelected:!0,valueField:"value",labelField:"text",options:i,render:{option:function(t,e){var i=t.text;return void 0===i?"<div><span>"+t.value+"</span></div>":"<div><span>"+i+"</span></div>"}},load:function(e,i){return!e.length||e.length<3?i():void t.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{string:encodeURIComponent(e),action:"vp_find_ajax_post"},error:function(){i()},success:function(t){i(t)}})}})}})}function n(){var e=t(".vp-multitag-wrapper input.input-sortable");e.each(function(){if(t(this).hasClass("selectized"));else{var e=t(this),i=e.parent(),n=i.find(".data-option"),a=!1;e.hasClass("vp-ajax-load")&&(a=!0),n.length&&(n=JSON.parse(n.text()),t(this).selectize({plugins:["drag_drop","remove_button"],options:n,persist:!0,create:!1,hideSelected:!0,valueField:"value",labelField:"text",render:{option:function(t,e){var i=t.text;return a?void 0===i?"<div><span>"+t.value+"</span></div>":"<div><span>"+i+"</span></div>":'<div class="'+t["class"]+'"><span>'+t.text+"</span></div>"}},load:function(e,i){if(a){if(!e.length||e.length<3)return i();t.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{string:encodeURIComponent(e),action:"vp_find_ajax_post_tag"},error:function(){i()},success:function(t){i(t)}})}}}))}})}function a(){var e=t(".vp-multiauthor-wrapper input.input-sortable");e.each(function(){if(t(this).hasClass("selectized"));else{var e=t(this),i=e.parent(),n=i.find(".data-option"),a=!1;e.hasClass("vp-ajax-load")&&(a=!0),n.length&&(n=JSON.parse(n.text()),t(this).selectize({plugins:["drag_drop","remove_button"],options:n,persist:!0,create:!1,hideSelected:!0,valueField:"value",labelField:"text",render:{option:function(t,e){var i=t.text;return a?void 0===i?"<div><span>"+t.value+"</span></div>":"<div><span>"+i+"</span></div>":'<div class="'+t["class"]+'"><span>'+t.text+"</span></div>"}},load:function(e,i){if(a){if(!e.length||e.length<3)return i();t.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{string:encodeURIComponent(e),action:"vp_find_ajax_author"},error:function(){i()},success:function(t){i(t)}})}}}))}})}function r(){var e=t(".vp-tabs");e.tabs()}function s(){a(),e(),i(),n(),r()}t(document).ready(s)}(jQuery);